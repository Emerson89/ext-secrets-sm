apiVersion: external-secrets.io/v1
kind: ClusterExternalSecret
metadata:
  name: my-ext-cluster-secret
spec:
  # The name to be used on the ExternalSecrets
  externalSecretName: "my-cluster-secret"

  namespaceSelectors:
  - matchLabels:
      secret: external

  # How often the ClusterExternalSecret should reconcile itself
  # This will decide how often to check and make sure that the ExternalSecrets exist in the matching namespaces
  refreshTime: "1m"

  # This is the spec of the ExternalSecrets to be created
  # The content of this was taken from our ExternalSecret example
  externalSecretSpec:
    secretStoreRef:
      name: aws-secrets-manager
      kind: ClusterSecretStore

    # RefreshPolicy determines how the ExternalSecret should be refreshed:
    # - CreatedOnce: Creates the Secret only if it does not exist and does not update it afterward
    # - Periodic: (default) Synchronizes the Secret at intervals specified by refreshInterval
    # - OnChange: Only synchronizes when the ExternalSecret's metadata or specification changes
    refreshPolicy: Periodic

    refreshInterval: "1h"
    target:
      name: my-secret-cluster
      creationPolicy: 'Owner'
    dataFrom:
    - extract:
      key: external-secrets